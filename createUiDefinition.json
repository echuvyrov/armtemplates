{
    "handler": "Microsoft.Compute.MultiVm",
    "version": "0.0.1-preview",
    "parameters": {
        "basics": [
            {
                "name": "adminUserName",
                "type": "Microsoft.Common.TextBox",
                "label": "VM user name",
                "defaultValue": "",
                "toolTip": "",
                "constraints": {
                    "required": true
                },
                "osPlatform": "Linux"
            },
            {
                "name": "adminPassword",
                "type": "Microsoft.Common.PasswordBox",
                "label": {
                    "password": "VM user password",
                    "confirmPassword": "Confirm password"
                },
                "toolTip": "",
                "constraints": {
                    "required": true,
                    "regex": "^((?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])|(?=.*[0-9])(?=.*[a-z])(?=.*[!@#$%^&*])|(?=.*[0-9])(?=.*[A-Z])(?=.*[!@#$%^&*])|(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*])).{6,72}$",
                    "validationMessage": "Password must be at least 6 characters long and have 3 out of the following: one number, one lower case, one upper case, or one special character"
                },
                "options": {
                    "hideConfirmation": false
                }
            },
			{
                "name": "vmName",
                "type": "Microsoft.Common.TextBox",
                "label": "VM Name",
                "defaultValue": "MyUbuntuVM",
                "toolTip": "Name for the Ubuntu Virtual Machine.",
                "constraints": {
                    "required": true
                },
                "osPlatform": "Linux"
            },
			{
                "name": "sqlSrvDBName",
                "type": "Microsoft.Common.TextBox",
                "label": "SQL Server DB Name",
                "defaultValue": "SqlServer14",
                "toolTip": "Name for the SQL Server Virtual Machine.",
                "constraints": {
                    "required": true
                },
                "osPlatform": "Linux"
            },
			{
                "name": "newStorageAccountName",
                "type": "Microsoft.Common.TextBox",
                "label": "VM Name",
                "defaultValue": "dgmultivmstr",
                "toolTip": "Unique DNS Name for the Storage Account where the Virtual Machine's disks will be placed.",
                "constraints": {
                    "required": true
                },
                "osPlatform": "Linux"
            },
			{
                "name": "dnsNameForPublicIP",
                "type": "Microsoft.Common.TextBox",
                "label": "VM Name",
                "defaultValue": "dgvmdnsubuntu",
                "toolTip": "Unique DNS Name for the Public IP used to access the Virtual Machine.",
                "constraints": {
                    "required": true
                },
                "osPlatform": "Linux"
            },
			{
                "name": "dnsNameForSQLPublicIP",
                "type": "Microsoft.Common.TextBox",
                "label": "VM Name",
                "defaultValue": "dgvmdnssql",
                "toolTip": "Unique DNS Name for the SQL Server Public IP used to access the Virtual Machine.",
                "constraints": {
                    "required": true
                },
                "osPlatform": "Linux"
            }
        ],
		
        "steps": [
            {
                "name": "infrastructureInfo",
                "label": "Infrastructure information",
                "subLabel": {
                    "preValidation": "Provide infrastructure information",
                    "postValidation": "Done"
                },
                "bladeTitle": "Infrastructure information",
                "elements": [
                    {
                        "name": "vmSize",
                        "type": "Microsoft.Compute.SizeSelector",
                        "label": "VM size",
                        "toolTip": "",
                        "recommendedSizes": [
                            "Standard_D13_v2",
                            "Standard_D14_v2"
                        ],
                        "constraints": {
                            "required": true,
                            "excludedSizes": [
                              "Basic_A0",
                              "Basic_A1",
                              "Basic_A2",
                              "Standard_A0",
                              "Standard_A1",
                              "Standard_A2",
                              "Standard_A5",
                              "Standard_D1",
                              "Standard_D2",
                              "Standard_D11",
                              "Standard_D1_v2",
                              "Standard_D2_v2",
                              "Standard_D11_v2",
                              "Standard_DS1",
                              "Standard_DS2",
                              "Standard_DS11",
                              "Standard_G1",
                              "Standard_GS1"
                            ]
                        },
                        "osPlatform": "Linux",
                        "imageReference": {
                            "publisher": "Canonical",
                            "offer": "UbuntuServer",
                            "sku": "14.04.3-LTS"
                        }
                    },
					{
                        "name": "sqlVMSize",
                        "type": "Microsoft.Compute.SizeSelector",
                        "label": "VM size for SQL Server",
                        "toolTip": "The size of the SQL VM Created",
                        "recommendedSizes": [
							"Standard_DS1",
							"Standard_DS2",
							"Standard_DS3",
							"Standard_DS4",
							"Standard_DS11",
							"Standard_DS12",
							"Standard_DS13",
							"Standard_DS14",
                            "Standard_D13_v2",
                            "Standard_D14_v2"
                        ],
                        "constraints": {
                            "required": true,
                            "excludedSizes": [
                              "Basic_A0",
                              "Basic_A1",
                              "Basic_A2",
                              "Standard_A0",
                              "Standard_A1",
                              "Standard_A2",
                              "Standard_A5",
                              "Standard_D1",
                              "Standard_D2",
                              "Standard_D11",
                              "Standard_D1_v2",
                              "Standard_D2_v2",
                              "Standard_D11_v2",
                              "Standard_G1",
                              "Standard_GS1"
                            ]
                        },
                        "osPlatform": "Windows",
                        "imageReference": {
                            "publisher": "MicrosoftSQLServer",
                            "offer": "SQL2014-WS2012R2",
                            "sku": "Standard"
                        }
                    }
					
                ]
            }
		],
		"outputs": {
            "location": "[location()]",
			"adminUserName":"[basics('adminUserName')]", 
			"adminPassword": "[basics('adminPassword')]",
			"vmName": "[basics('vmName')]",
			"sqlSrvDBName": "[basics('sqlSrvDBName')]",
			"newStorageAccountName": "[basics('newStorageAccountName')]",
			"dnsNameForPublicIP": "[basics('dnsNameForPublicIP')]",
			"dnsNameForSQLPublicIP": "[basics('dnsNameForSQLPublicIP')]",
			"sqlVMSize": "[steps('infrastructureInfo').sqlVMSize]",
			"vMSize": "[steps('infrastructureInfo').vMSize]"
       }
    }
}